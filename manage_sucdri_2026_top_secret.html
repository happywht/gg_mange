<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç³»ç»Ÿç®¡ç† - Google æµ·å¤–è´¦å·åŠ©æ‰‹</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Supabase å’Œè®¤è¯ç³»ç»Ÿï¼ˆæŒ‰é¡ºåºåŠ è½½ï¼‰ -->
  <script src="supabase-config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="auth-manager.js"></script>
  <script src="auth-check.js"></script>

  <style>
    body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
    .password-strength { height: 4px; border-radius: 2px; background: #e5e7eb; overflow: hidden; }
    .password-strength-fill { height: 100%; transition: all 0.3s; }
  </style>
</head>
<body class="bg-slate-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const supabase = (typeof window !== 'undefined' && window.SUPABASE_URL && window.SUPABASE_ANON_KEY && typeof window.supabase !== 'undefined')
      ? window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY)
      : null;
    const useSupabase = !!supabase;

    const STORAGE_KEYS = {
      accounts: 'google_assistant_accounts',
      announcement: 'google_assistant_announcement',
      config: 'google_assistant_config'
    };
    const DEFAULT_CONFIG = {
      contact: { name: 'ç‹æµ·æ¶›', email: 'wanghaitao@sucdri.com', openId: 'ou_f28f2c1dfe74461b2ca055dfe2afe20b' },
      buttons: {
        guide: { visible: true, text: 'æ“ä½œè¯´æ˜', url: '' },
        gemini: { visible: true, text: 'ç™»å½• Google', url: 'https://accounts.google.com' }
      },
      permissions: {
        showAddAccount: true,
        showDeleteButton: true,
        showModeSwitch: true
      },
      visibleServices: []
    };
    // ä¼˜å…ˆä½¿ç”¨ auth-config.js ä¸­çš„å¯†ç ï¼Œå¦åˆ™ä½¿ç”¨ localStorage ä¸­çš„å¯†ç ï¼Œæœ€åä½¿ç”¨é»˜è®¤å¯†ç 
    const ADMIN_PASSWORD = window.ADMIN_PASSWORD || localStorage.getItem('google_assistant_admin_password') || 'admin123';


    // å›¾æ ‡ç»„ä»¶
    const Icon = ({ name, size = 20, className = "" }) => {
      const icons = {
        user: <><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></>,
        key: <><path d="m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4.1a1 1 0 0 0-1.4 0l-2.1 2.1a1 1 0 0 0 0 1.4Z" /><path d="m10.5 12.5 1.5 1.5" /><path d="M11 11l4.5-4.5" /><path d="M4.5 16.5 7 14" /><path d="M3 21l3-3" /><path d="m21 3-5 5" /><path d="M14 9a7 7 0 1 1-10 10 7 7 0 0 1 10-10Z" /></>,
        plus: <><path d="M12 5v14" /><path d="M5 12h14" /></>,
        trash: <><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><path d="M10 11v6" /><path d="M14 11v6" /></>,
        edit: <><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z" /><path d="m15 5 4 4" /></>,
        save: <><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" /><polyline points="17 21 17 13 7 13 7 21" /><polyline points="7 3 7 8 15 8" /></>,
        bell: <><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" /><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" /></>,
        message: <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10Z" />,
        refresh: <><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /><path d="M3 3v5h5" /><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16" /><path d="M16 21h5v-5" /></>,
        database: <><ellipse cx="12" cy="5" rx="9" ry="3" /><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" /><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" /></>,
        settings: <><path d="M12.22 2h-.44a2 2 0 0 1-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></>,
        home: <><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></>,
        lock: <><rect width="18" height="11" x="3" y="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></>,
        check: <path d="M20 6 9 17l-5-5" />,
        x: <><path d="M18 6 6 18" /><path d="M6 6l12 12" /></>,
        eye: <><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" /><circle cx="12" cy="12" r="3" /></>,
        eyeOff: <><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24" /><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68" /><path d="M6.61 6.61A13.52 13.52 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61" /><path d="m2 2 20 20" /></>,
        toggleOn: <><rect width="44" height="24" x="2" y="5" rx="12" fill="currentColor" /></>,
        toggleOff: <><rect width="44" height="24" x="2" y="5" rx="12" stroke="currentColor" fill="none" strokeWidth="2" /></>,
        sparkles: <path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z" />,
      };

      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {icons[name] || null}
        </svg>
      );
    };

    const AdminPanel = () => {
      const [authenticated, setAuthenticated] = useState(false);
      const [password, setPassword] = useState('');
      const [activeTab, setActiveTab] = useState('accounts');

      // æ•°æ®çŠ¶æ€
      const [accounts, setAccounts] = useState([]);
      const [announcement, setAnnouncement] = useState(null);
      const [config, setConfig] = useState({ contact: { name: '', email: '', feishuUrl: '' } });
      const [dbData, setDbData] = useState([]);

      // è¡¨å•çŠ¶æ€
      const [editingAccount, setEditingAccount] = useState(null);
      const [newAccount, setNewAccount] = useState({ name: '', email: '', password: '', secret: '' });
      const [newAnnouncement, setNewAnnouncement] = useState('');
      const [contactForm, setContactForm] = useState({ name: '', email: '', openId: '' });
      const [buttonConfigs, setButtonConfigs] = useState({});
      const [permissions, setPermissions] = useState({
        showAddAccount: true,
        showDeleteButton: true,
        showModeSwitch: true
      });
      const [visibleServices, setVisibleServices] = useState([]);

      // å¯ç”¨çš„AIæœåŠ¡åˆ—è¡¨
      const AVAILABLE_SERVICES = [
        { id: 'gemini', name: 'Gemini', color: 'bg-blue-500' },
        { id: 'notebooklm', name: 'NotebookLM', color: 'bg-emerald-500' },
        { id: 'cursor', name: 'Cursor', color: 'bg-violet-500' },
        { id: 'chatgpt', name: 'ChatGPT', color: 'bg-green-500' }
      ];

      // æ¶ˆæ¯æç¤º
      const [message, setMessage] = useState(null);

      // ç™»å½•
      const handleLogin = (e) => {
        e.preventDefault();
        // ç›´æ¥ä» window.ADMIN_PASSWORD è¯»å–ï¼Œæ”¯æŒåŠ¨æ€ä¿®æ”¹å¯†ç 
        if (password === window.ADMIN_PASSWORD) {
          setAuthenticated(true);
          loadAllData();
        } else {
          showMessage('å¯†ç é”™è¯¯', 'error');
        }
      };

      // æ˜¾ç¤ºæ¶ˆæ¯
      const showMessage = (text, type = 'success') => {
        setMessage({ text, type });
        setTimeout(() => setMessage(null), 3000);
      };

      // åŠ è½½æ‰€æœ‰æ•°æ®ï¼šSupabase æˆ– localStorage
      const loadAllData = async () => {
        try {
          if (useSupabase && supabase) {
            const [accRes, annRes, confRes] = await Promise.all([
              supabase.from('accounts').select('*').order('created_at', { ascending: false }),
              supabase.from('announcements').select('*').order('created_at', { ascending: false }).limit(1),
              supabase.from('config').select('*').eq('id', 'default').single()
            ]);
            const accList = accRes.data || [];
            setAccounts(accList);
            setDbData(accList);
            setAnnouncement(annRes.data && annRes.data[0] ? annRes.data[0] : null);
            const conf = confRes.data || {};
            const contact = { ...DEFAULT_CONFIG.contact, ...conf.contact };
            const buttons = { ...DEFAULT_CONFIG.buttons, ...conf.buttons };
            const perms = conf.permissions || { showAddAccount: true, showDeleteButton: true, showModeSwitch: true };
            const services = conf.visible_services || DEFAULT_CONFIG.visibleServices || [];
            setConfig({ contact, buttons });
            setButtonConfigs(buttons);
            setPermissions(perms);
            setVisibleServices(services);
            setContactForm({ name: contact.name || '', email: contact.email || '', openId: contact.openId || '' });
          } else {
            const rawAcc = localStorage.getItem(STORAGE_KEYS.accounts) || '[]';
            const accList = JSON.parse(rawAcc);
            setAccounts(accList);
            setDbData(accList);
            const rawAnn = localStorage.getItem(STORAGE_KEYS.announcement);
            setAnnouncement(rawAnn ? JSON.parse(rawAnn) : null);
            const rawConf = localStorage.getItem(STORAGE_KEYS.config);
            const conf = rawConf ? JSON.parse(rawConf) : DEFAULT_CONFIG;
            const contact = { ...DEFAULT_CONFIG.contact, ...conf.contact };
            const buttons = { ...DEFAULT_CONFIG.buttons, ...conf.buttons };
            setConfig({ contact, buttons });
            setButtonConfigs(buttons);
            setContactForm({ name: contact.name || '', email: contact.email || '', openId: contact.openId || '' });
          }
        } catch (err) {
          showMessage('åŠ è½½æ•°æ®å¤±è´¥', 'error');
        }
      };

      // è´¦å·æ“ä½œ
      const handleAddAccount = async () => {
        if (!newAccount.email || !newAccount.password) {
          showMessage('é‚®ç®±å’Œå¯†ç ä¸èƒ½ä¸ºç©º', 'error');
          return;
        }
        const id = Date.now().toString();
        const now = new Date().toISOString();
        const item = { id, name: newAccount.name || '', email: newAccount.email, password: newAccount.password, secret: newAccount.secret || '', created_at: now, updated_at: now };
        if (useSupabase && supabase) {
          const { error } = await supabase.from('accounts').insert(item);
          if (error) { showMessage(error.message || 'æ·»åŠ å¤±è´¥', 'error'); return; }
        } else {
          const list = [...accounts, item];
          localStorage.setItem(STORAGE_KEYS.accounts, JSON.stringify(list));
        }
        showMessage('è´¦å·æ·»åŠ æˆåŠŸ');
        setNewAccount({ name: '', email: '', password: '', secret: '' });
        loadAllData();
      };

      const handleUpdateAccount = async (id) => {
        const now = new Date().toISOString();
        const item = { ...editingAccount, id, updated_at: now };
        if (useSupabase && supabase) {
          const { error } = await supabase.from('accounts').update({ name: item.name, email: item.email, password: item.password, secret: item.secret || '', updated_at: now }).eq('id', id);
          if (error) { showMessage(error.message || 'æ›´æ–°å¤±è´¥', 'error'); return; }
        } else {
          const list = accounts.map(a => a.id === id ? item : a);
          localStorage.setItem(STORAGE_KEYS.accounts, JSON.stringify(list));
        }
        showMessage('è´¦å·æ›´æ–°æˆåŠŸ');
        setEditingAccount(null);
        loadAllData();
      };

      const handleDeleteAccount = async (id) => {
        if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè´¦å·å—ï¼Ÿ')) return;
        if (useSupabase && supabase) {
          const { error } = await supabase.from('accounts').delete().eq('id', id);
          if (error) { showMessage(error.message || 'åˆ é™¤å¤±è´¥', 'error'); return; }
        } else {
          const list = accounts.filter(a => a.id !== id);
          localStorage.setItem(STORAGE_KEYS.accounts, JSON.stringify(list));
        }
        showMessage('è´¦å·åˆ é™¤æˆåŠŸ');
        loadAllData();
      };

      // å…¬å‘Šæ“ä½œ
      const handleUpdateAnnouncement = async () => {
        if (!newAnnouncement.trim()) {
          showMessage('å…¬å‘Šå†…å®¹ä¸èƒ½ä¸ºç©º', 'error');
          return;
        }
        const item = { id: Date.now().toString(), message: newAnnouncement.trim(), created_at: new Date().toISOString() };
        if (useSupabase && supabase) {
          const { error } = await supabase.from('announcements').insert(item);
          if (error) { showMessage(error.message || 'å‘å¸ƒå¤±è´¥', 'error'); return; }
        } else {
          localStorage.setItem(STORAGE_KEYS.announcement, JSON.stringify(item));
        }
        showMessage('å…¬å‘Šå‘å¸ƒæˆåŠŸ');
        setNewAnnouncement('');
        loadAllData();
      };

      const handleDeleteAnnouncement = async () => {
        if (useSupabase && supabase) {
          const { data: list } = await supabase.from('announcements').select('id');
          const ids = (list || []).map(r => r.id);
          if (ids.length) {
            const { error } = await supabase.from('announcements').delete().in('id', ids);
            if (error) { showMessage(error.message || 'åˆ é™¤å¤±è´¥', 'error'); return; }
          }
        } else {
          localStorage.removeItem(STORAGE_KEYS.announcement);
        }
        showMessage('å…¬å‘Šå·²åˆ é™¤');
        loadAllData();
      };

      // æŠ€æœ¯æ”¯æŒé…ç½®
      const handleUpdateContact = async () => {
        if (useSupabase && supabase) {
          const { data: cur } = await supabase.from('config').select('*').eq('id', 'default').single();
          const contact = { ...DEFAULT_CONFIG.contact, ...(cur && cur.contact), ...contactForm };
          const buttons = (cur && cur.buttons) || DEFAULT_CONFIG.buttons;
          const { error } = await supabase.from('config').upsert({ id: 'default', contact, buttons }, { onConflict: 'id' });
          if (error) { showMessage(error.message || 'æ›´æ–°å¤±è´¥', 'error'); return; }
        } else {
          const raw = localStorage.getItem(STORAGE_KEYS.config);
          const conf = raw ? JSON.parse(raw) : { contact: {}, buttons: {} };
          conf.contact = { ...DEFAULT_CONFIG.contact, ...contactForm };
          localStorage.setItem(STORAGE_KEYS.config, JSON.stringify(conf));
        }
        showMessage('é…ç½®æ›´æ–°æˆåŠŸ');
        loadAllData();
      };

      // æŒ‰é’®é…ç½®
      const handleUpdateButton = async (key, cfg) => {
        if (useSupabase && supabase) {
          const { data: cur } = await supabase.from('config').select('*').eq('id', 'default').single();
          const contact = (cur && cur.contact) || DEFAULT_CONFIG.contact;
          const buttons = { ...(cur && cur.buttons), ...DEFAULT_CONFIG.buttons };
          buttons[key] = { ...(buttons[key] || {}), ...cfg };
          const { error } = await supabase.from('config').upsert({ id: 'default', contact, buttons }, { onConflict: 'id' });
          if (error) { showMessage(error.message || 'æ›´æ–°å¤±è´¥', 'error'); return; }
        } else {
          const raw = localStorage.getItem(STORAGE_KEYS.config);
          const conf = raw ? JSON.parse(raw) : { contact: DEFAULT_CONFIG.contact, buttons: DEFAULT_CONFIG.buttons };
          conf.buttons = conf.buttons || {};
          conf.buttons[key] = { ...(conf.buttons[key] || {}), ...cfg };
          localStorage.setItem(STORAGE_KEYS.config, JSON.stringify(conf));
        }
        showMessage('æŒ‰é’®é…ç½®æ›´æ–°æˆåŠŸ');
        loadAllData();
      };

      // æƒé™é…ç½®
      const handleUpdatePermissions = async () => {
        if (useSupabase && supabase) {
          const { data: cur } = await supabase.from('config').select('*').eq('id', 'default').single();
          const contact = (cur && cur.contact) || DEFAULT_CONFIG.contact;
          const buttons = (cur && cur.buttons) || DEFAULT_CONFIG.buttons;
          const { error } = await supabase.from('config').upsert(
            { id: 'default', contact, buttons, permissions },
            { onConflict: 'id' }
          );
          if (error) { showMessage(error.message || 'æ›´æ–°å¤±è´¥', 'error'); return; }
        } else {
          const raw = localStorage.getItem(STORAGE_KEYS.config);
          const conf = raw ? JSON.parse(raw) : { contact: DEFAULT_CONFIG.contact, buttons: DEFAULT_CONFIG.buttons };
          conf.permissions = permissions;
          localStorage.setItem(STORAGE_KEYS.config, JSON.stringify(conf));
        }
        showMessage('æƒé™é…ç½®æ›´æ–°æˆåŠŸ');
        loadAllData();
      };

      // AIæœåŠ¡é…ç½®
      const handleUpdateServices = async () => {
        if (useSupabase && supabase) {
          const { data: cur } = await supabase.from('config').select('*').eq('id', 'default').single();
          const contact = (cur && cur.contact) || DEFAULT_CONFIG.contact;
          const buttons = (cur && cur.buttons) || DEFAULT_CONFIG.buttons;
          const perms = (cur && cur.permissions) || DEFAULT_CONFIG.permissions;
          const { error } = await supabase.from('config').upsert(
            { id: 'default', contact, buttons, permissions: perms, visible_services: visibleServices },
            { onConflict: 'id' }
          );
          if (error) { showMessage(error.message || 'æ›´æ–°å¤±è´¥', 'error'); return; }
        } else {
          const raw = localStorage.getItem(STORAGE_KEYS.config);
          const conf = raw ? JSON.parse(raw) : { contact: DEFAULT_CONFIG.contact, buttons: DEFAULT_CONFIG.buttons };
          conf.visibleServices = visibleServices;
          localStorage.setItem(STORAGE_KEYS.config, JSON.stringify(conf));
        }
        showMessage('AIæœåŠ¡é…ç½®æ›´æ–°æˆåŠŸ');
        loadAllData();
      };

      // ç™»å½•ç•Œé¢
      if (!authenticated) {
        return (
          <div className="min-h-screen flex items-center justify-center bg-slate-100">
            <div className="bg-white rounded-md border border-slate-200 p-8 w-full max-w-md">
              <div className="text-center mb-8">
                <div className="w-16 h-16 bg-[#1a3a5f] rounded-md flex items-center justify-center mx-auto mb-4">
                  <Icon name="lock" size={32} className="text-white" />
                </div>
                <h1 className="text-2xl font-bold text-slate-800">ç³»ç»Ÿç®¡ç†</h1>
                <p className="text-slate-500 text-sm mt-2">è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç </p>
              </div>

              <form onSubmit={handleLogin}>
                <div className="mb-6">
                  <input
                    type="password"
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    placeholder="ç®¡ç†å‘˜å¯†ç "
                    className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                    autoFocus
                  />
                </div>
                <button
                  type="submit"
                  className="w-full py-3 bg-[#1a3a5f] hover:bg-[#254a7a] text-white rounded-md font-semibold transition-colors"
                >
                  ç™»å½•
                </button>
              </form>
            </div>
          </div>
        );
      }

      // ä¸»ç•Œé¢
      return (
        <div className="min-h-screen bg-slate-100">
          {/* é¡¶éƒ¨å¯¼èˆª */}
          <header className="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-10">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="flex justify-between items-center h-16">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-[#1a3a5f] rounded-md flex items-center justify-center">
                    <Icon name="settings" size={20} className="text-white" />
                  </div>
                  <h1 className="text-xl font-bold text-slate-800">ç³»ç»Ÿç®¡ç†</h1>
                </div>
                <div className="flex items-center gap-2">
                  <a
                    href="/"
                    className="flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors"
                  >
                    <Icon name="home" size={18} />
                    è¿”å›é¦–é¡µ
                  </a>
                </div>
              </div>
            </div>
          </header>

          {/* æ ‡ç­¾å¯¼èˆª */}
          <div className="bg-white border-b border-slate-200">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <nav className="flex gap-8">
                {[
                  { key: 'accounts', label: 'è´¦å·ç®¡ç†', icon: 'user' },
                  { key: 'announcement', label: 'å…¬å‘Šç®¡ç†', icon: 'bell' },
                  { key: 'contact', label: 'æŠ€æœ¯æ”¯æŒ', icon: 'message' },
                  { key: 'buttons', label: 'æŒ‰é’®é…ç½®', icon: 'settings' },
                  { key: 'permissions', label: 'æƒé™é…ç½®', icon: 'lock' },
                  { key: 'services', label: 'AIæœåŠ¡', icon: 'sparkles' },
                  { key: 'database', label: 'æ•°æ®åº“', icon: 'database' },
                ].map(tab => (
                  <button
                    key={tab.key}
                    onClick={() => setActiveTab(tab.key)}
                    className={`flex items-center gap-2 px-4 py-4 border-b-2 transition-colors ${
                      activeTab === tab.key
                        ? 'border-blue-600 text-blue-600 font-semibold'
                        : 'border-transparent text-slate-500 hover:text-slate-700'
                    }`}
                  >
                    <Icon name={tab.icon} size={18} />
                    {tab.label}
                  </button>
                ))}
              </nav>
            </div>
          </div>

          {/* å†…å®¹åŒºåŸŸ */}
          <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            {/* æ¶ˆæ¯æç¤º */}
            {message && (
              <div className={`mb-6 p-4 rounded-xl flex items-center justify-between ${
                message.type === 'error' ? 'bg-red-50 text-red-700 border border-red-200' : 'bg-green-50 text-green-700 border border-green-200'
              }`}>
                <span>{message.text}</span>
                <button onClick={() => setMessage(null)} className="p-1 hover:bg-white/50 rounded">
                  <Icon name="x" size={16} />
                </button>
              </div>
            )}

            {/* è´¦å·ç®¡ç† */}
            {activeTab === 'accounts' && (
              <div className="space-y-6">
                {/* æ·»åŠ è´¦å· */}
                <div className="bg-white rounded-md border border-slate-200 p-6">
                  <h2 className="text-lg font-semibold mb-4 flex items-center gap-2">
                    <Icon name="plus" size={20} />
                    æ·»åŠ æ–°è´¦å·
                  </h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                    <input
                      placeholder="å¤‡æ³¨åç§°"
                      value={newAccount.name}
                      onChange={(e) => setNewAccount({ ...newAccount, name: e.target.value })}
                      className="px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                    <input
                      placeholder="Google è´¦å·"
                      value={newAccount.email}
                      onChange={(e) => setNewAccount({ ...newAccount, email: e.target.value })}
                      className="px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                    <input
                      type="password"
                      placeholder="å¯†ç "
                      value={newAccount.password}
                      onChange={(e) => setNewAccount({ ...newAccount, password: e.target.value })}
                      className="px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                    <input
                      placeholder="2FA å¯†é’¥"
                      value={newAccount.secret}
                      onChange={(e) => setNewAccount({ ...newAccount, secret: e.target.value })}
                      className="px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                  <button
                    onClick={handleAddAccount}
                    className="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors"
                  >
                    æ·»åŠ è´¦å·
                  </button>
                </div>

                {/* è´¦å·åˆ—è¡¨ */}
                <div className="bg-white rounded-md border border-slate-200 overflow-hidden">
                  <table className="w-full">
                    <thead className="bg-slate-50 border-b border-slate-200">
                      <tr>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase">å¤‡æ³¨</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase">è´¦å·</th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase">å¯†ç </th>
                        <th className="px-6 py-3 text-left text-xs font-semibold text-slate-600 uppercase">2FA</th>
                        <th className="px-6 py-3 text-right text-xs font-semibold text-slate-600 uppercase">æ“ä½œ</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-200">
                      {accounts.map(acc => (
                        <tr key={acc.id} className="hover:bg-slate-50">
                          {editingAccount?.id === acc.id ? (
                            <>
                              <td className="px-6 py-4">
                                <input
                                  value={editingAccount.name}
                                  onChange={(e) => setEditingAccount({ ...editingAccount, name: e.target.value })}
                                  className="px-3 py-1 border rounded w-full"
                                />
                              </td>
                              <td className="px-6 py-4">
                                <input
                                  value={editingAccount.email}
                                  onChange={(e) => setEditingAccount({ ...editingAccount, email: e.target.value })}
                                  className="px-3 py-1 border rounded w-full"
                                />
                              </td>
                              <td className="px-6 py-4">
                                <input
                                  value={editingAccount.password}
                                  onChange={(e) => setEditingAccount({ ...editingAccount, password: e.target.value })}
                                  className="px-3 py-1 border rounded w-full"
                                />
                              </td>
                              <td className="px-6 py-4">
                                <input
                                  value={editingAccount.secret}
                                  onChange={(e) => setEditingAccount({ ...editingAccount, secret: e.target.value })}
                                  className="px-3 py-1 border rounded w-full"
                                />
                              </td>
                              <td className="px-6 py-4 text-right">
                                <button
                                  onClick={() => handleUpdateAccount(acc.id)}
                                  className="px-3 py-1 bg-green-600 text-white rounded text-sm mr-2"
                                >
                                  <Icon name="save" size={16} />
                                </button>
                                <button
                                  onClick={() => setEditingAccount(null)}
                                  className="px-3 py-1 bg-slate-400 text-white rounded text-sm"
                                >
                                  å–æ¶ˆ
                                </button>
                              </td>
                            </>
                          ) : (
                            <>
                              <td className="px-6 py-4 font-medium">{acc.name || '-'}</td>
                              <td className="px-6 py-4">{acc.email}</td>
                              <td className="px-6 py-4 font-mono text-sm">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</td>
                              <td className="px-6 py-4">{acc.secret ? 'â—â—â—â—â—â—' : '-'}</td>
                              <td className="px-6 py-4 text-right">
                                <button
                                  onClick={() => setEditingAccount(acc)}
                                  className="p-2 text-blue-600 hover:bg-blue-50 rounded-lg mr-1"
                                  title="ç¼–è¾‘"
                                >
                                  <Icon name="edit" size={16} />
                                </button>
                                <button
                                  onClick={() => handleDeleteAccount(acc.id)}
                                  className="p-2 text-red-600 hover:bg-red-50 rounded-lg"
                                  title="åˆ é™¤"
                                >
                                  <Icon name="trash" size={16} />
                                </button>
                              </td>
                            </>
                          )}
                        </tr>
                      ))}
                      {accounts.length === 0 && (
                        <tr>
                          <td colSpan="5" className="px-6 py-12 text-center text-slate-400">
                            æš‚æ— è´¦å·æ•°æ®
                          </td>
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {/* å…¬å‘Šç®¡ç† */}
            {activeTab === 'announcement' && (
              <div className="space-y-6">
                <div className="bg-white rounded-md border border-slate-200 p-6">
                  <h2 className="text-lg font-semibold mb-4">å‘å¸ƒå…¬å‘Š</h2>
                  <textarea
                    value={newAnnouncement}
                    onChange={(e) => setNewAnnouncement(e.target.value)}
                    placeholder="è¾“å…¥å…¬å‘Šå†…å®¹..."
                    className="w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none resize-none"
                    rows={3}
                  />
                  <div className="mt-4 flex gap-3">
                    <button
                      onClick={handleUpdateAnnouncement}
                      className="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors"
                    >
                      å‘å¸ƒå…¬å‘Š
                    </button>
                    {announcement && (
                      <button
                        onClick={handleDeleteAnnouncement}
                        className="px-6 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors"
                      >
                        åˆ é™¤å½“å‰å…¬å‘Š
                      </button>
                    )}
                  </div>
                </div>

                {/* å½“å‰å…¬å‘Š */}
                {announcement && (
                  <div className="bg-blue-50 border border-blue-200 rounded-md p-6">
                    <div className="flex items-start justify-between">
                      <div>
                        <h3 className="text-sm font-semibold text-blue-900 mb-2">å½“å‰å…¬å‘Š</h3>
                        <p className="text-blue-800">{announcement.message}</p>
                        <p className="text-blue-600 text-xs mt-2">å‘å¸ƒæ—¶é—´: {announcement.created_at}</p>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* æŠ€æœ¯æ”¯æŒé…ç½® */}
            {activeTab === 'contact' && (
              <div className="bg-white rounded-md border border-slate-200 p-6">
                <h2 className="text-lg font-semibold mb-6">æŠ€æœ¯æ”¯æŒé…ç½®</h2>
                <div className="space-y-4 max-w-lg">
                  <div>
                    <label className="block text-sm font-medium text-slate-700 mb-2">è”ç³»äººåç§°</label>
                    <input
                      type="text"
                      value={contactForm.name}
                      onChange={(e) => setContactForm({ ...contactForm, name: e.target.value })}
                      className="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-slate-700 mb-2">è”ç³»é‚®ç®±</label>
                    <input
                      type="email"
                      value={contactForm.email}
                      onChange={(e) => setContactForm({ ...contactForm, email: e.target.value })}
                      className="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-slate-700 mb-2">
                      é£ä¹¦ Open ID
                      <a
                        href="https://open.feishu.cn/document/server-docs/contact-v3/user/batch_get_id"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="ml-2 text-blue-600 text-xs hover:underline"
                      >
                        å¦‚ä½•è·å–?
                      </a>
                    </label>
                    <input
                      type="text"
                      value={contactForm.openId}
                      onChange={(e) => setContactForm({ ...contactForm, openId: e.target.value })}
                      placeholder="ou_xxxxxxxxxxxxxxxx"
                      className="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm"
                    />
                  </div>
                  <button
                    onClick={handleUpdateContact}
                    className="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors"
                  >
                    ä¿å­˜é…ç½®
                  </button>
                </div>

                {/* é¢„è§ˆ */}
                <div className="mt-8 pt-8 border-t border-slate-200">
                  <h3 className="text-sm font-semibold text-slate-700 mb-4">é¢„è§ˆ</h3>
                  <div className="p-4 bg-slate-50 rounded-lg">
                    <p className="text-sm text-slate-600">
                      <span className="font-medium">æŠ€æœ¯æ”¯æŒ:</span> {contactForm.name}
                    </p>
                    <p className="text-sm text-slate-600 mt-1">
                      <span className="font-medium">é‚®ç®±:</span> {contactForm.email}
                    </p>
                    <p className="text-sm text-slate-600 mt-1">
                      <span className="font-medium">é£ä¹¦é“¾æ¥:</span>
                      <code className="ml-2 px-2 py-0.5 bg-slate-200 rounded text-xs">
                        {contactForm.openId ? `https://applink.feishu.cn/client/chat/open?openId=${contactForm.openId}` : 'æœªé…ç½®'}
                      </code>
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* æŒ‰é’®é…ç½® */}
            {activeTab === 'buttons' && (
              <div className="space-y-6">
                {[
                  { key: 'guide', label: 'æ“ä½œè¯´æ˜', desc: 'æ˜¾ç¤ºè´¦å·ç™»å½•æ“ä½œæŒ‡å—å¼¹çª—' },
                  { key: 'gemini', label: 'ç™»å½• Google', desc: 'è·³è½¬åˆ° Google è´¦å·ç™»å½•é¡µ' },
                ].map(btn => (
                  <div key={btn.key} className="bg-white rounded-md border border-slate-200 p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div>
                        <h3 className="font-semibold text-slate-800">{btn.label}</h3>
                        <p className="text-sm text-slate-500">{btn.desc}</p>
                      </div>
                      <label className="flex items-center gap-2 cursor-pointer">
                        <span className="text-sm text-slate-600">æ˜¾ç¤º</span>
                        <input
                          type="checkbox"
                          checked={buttonConfigs[btn.key]?.visible !== false}
                          onChange={(e) => handleUpdateButton(btn.key, { ...buttonConfigs[btn.key], visible: e.target.checked })}
                          className="w-5 h-5 rounded text-blue-600"
                        />
                      </label>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-medium text-slate-700 mb-2">æŒ‰é’®æ–‡å­—</label>
                        <input
                          type="text"
                          value={buttonConfigs[btn.key]?.text || btn.label}
                          onChange={(e) => handleUpdateButton(btn.key, { ...buttonConfigs[btn.key], text: e.target.value })}
                          className="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                        />
                      </div>
                      <div>
                        <label className="block text-sm font-medium text-slate-700 mb-2">è·³è½¬é“¾æ¥</label>
                        <input
                          type="text"
                          value={buttonConfigs[btn.key]?.url || ''}
                          onChange={(e) => handleUpdateButton(btn.key, { ...buttonConfigs[btn.key], url: e.target.value })}
                          placeholder={btn.key === 'gemini' ? 'https://accounts.google.com' : 'javascript:void(0)'}
                          className="w-full px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm"
                        />
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* æƒé™é…ç½® */}
            {activeTab === 'permissions' && (
              <div className="space-y-6">
                <div className="bg-white rounded-md border border-slate-200 p-6">
                  <h2 className="text-lg font-semibold mb-6">å‰ç«¯åŠŸèƒ½æƒé™é…ç½®</h2>
                  <p className="text-slate-500 text-sm mb-6">æ§åˆ¶é¦–é¡µæ˜¾ç¤ºå“ªäº›åŠŸèƒ½æŒ‰é’®ã€‚å…³é—­åï¼Œæ™®é€šç”¨æˆ·æ— æ³•çœ‹åˆ°ç›¸åº”åŠŸèƒ½ã€‚</p>

                  <div className="space-y-4">
                    {/* æ˜¾ç¤ºæ·»åŠ è´¦å·åŠŸèƒ½ */}
                    <div className="flex items-center justify-between p-4 bg-slate-50 rounded-md border border-slate-200">
                      <div className="flex items-center gap-4">
                        <div className="w-10 h-10 bg-[#1a3a5f] rounded-md flex items-center justify-center">
                          <Icon name="plus" size={20} className="text-white" />
                        </div>
                        <div>
                          <h3 className="font-semibold text-slate-800">æ·»åŠ è´¦å·åŠŸèƒ½</h3>
                          <p className="text-sm text-slate-500">æ§åˆ¶é¦–é¡µæ˜¯å¦æ˜¾ç¤º"æ·»åŠ æ–°è´¦å·"è¾“å…¥æ¡†</p>
                        </div>
                      </div>
                      <label className="flex items-center gap-3 cursor-pointer">
                        <span className="text-sm text-slate-600">{permissions.showAddAccount ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}</span>
                        <button
                          onClick={() => setPermissions({ ...permissions, showAddAccount: !permissions.showAddAccount })}
                          className={`w-14 h-7 rounded-full transition-colors ${permissions.showAddAccount ? 'bg-[#1a3a5f]' : 'bg-slate-300'}`}
                        >
                          <div className={`w-5 h-5 bg-white rounded-full shadow transition-transform ${permissions.showAddAccount ? 'translate-x-7' : 'translate-x-1'}`} />
                        </button>
                      </label>
                    </div>

                    {/* æ˜¾ç¤ºåˆ é™¤æŒ‰é’® */}
                    <div className="flex items-center justify-between p-4 bg-slate-50 rounded-md border border-slate-200">
                      <div className="flex items-center gap-4">
                        <div className="w-10 h-10 bg-[#1a3a5f] rounded-md flex items-center justify-center">
                          <Icon name="trash" size={20} className="text-white" />
                        </div>
                        <div>
                          <h3 className="font-semibold text-slate-800">åˆ é™¤æŒ‰é’®</h3>
                          <p className="text-sm text-slate-500">æ§åˆ¶è´¦å·å¡ç‰‡æ˜¯å¦æ˜¾ç¤ºåˆ é™¤æŒ‰é’®</p>
                        </div>
                      </div>
                      <label className="flex items-center gap-3 cursor-pointer">
                        <span className="text-sm text-slate-600">{permissions.showDeleteButton ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}</span>
                        <button
                          onClick={() => setPermissions({ ...permissions, showDeleteButton: !permissions.showDeleteButton })}
                          className={`w-14 h-7 rounded-full transition-colors ${permissions.showDeleteButton ? 'bg-[#1a3a5f]' : 'bg-slate-300'}`}
                        >
                          <div className={`w-5 h-5 bg-white rounded-full shadow transition-transform ${permissions.showDeleteButton ? 'translate-x-7' : 'translate-x-1'}`} />
                        </button>
                      </label>
                    </div>

                    {/* æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢ */}
                    <div className="flex items-center justify-between p-4 bg-slate-50 rounded-md border border-slate-200">
                      <div className="flex items-center gap-4">
                        <div className="w-10 h-10 bg-[#1a3a5f] rounded-md flex items-center justify-center">
                          <Icon name="database" size={20} className="text-white" />
                        </div>
                        <div>
                          <h3 className="font-semibold text-slate-800">æœ¬åœ°/äº‘ç«¯æ¨¡å¼åˆ‡æ¢</h3>
                          <p className="text-sm text-slate-500">æ§åˆ¶é¦–é¡µæ˜¯å¦æ˜¾ç¤ºå­˜å‚¨æ¨¡å¼åˆ‡æ¢æŒ‰é’®</p>
                        </div>
                      </div>
                      <label className="flex items-center gap-3 cursor-pointer">
                        <span className="text-sm text-slate-600">{permissions.showModeSwitch ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}</span>
                        <button
                          onClick={() => setPermissions({ ...permissions, showModeSwitch: !permissions.showModeSwitch })}
                          className={`w-14 h-7 rounded-full transition-colors ${permissions.showModeSwitch ? 'bg-[#1a3a5f]' : 'bg-slate-300'}`}
                        >
                          <div className={`w-5 h-5 bg-white rounded-full shadow transition-transform ${permissions.showModeSwitch ? 'translate-x-7' : 'translate-x-1'}`} />
                        </button>
                      </label>
                    </div>
                  </div>

                  <div className="mt-8 pt-6 border-t border-slate-200">
                    <button
                      onClick={handleUpdatePermissions}
                      className="px-6 py-2 bg-[#1a3a5f] hover:bg-[#254a7a] text-white rounded-md font-medium transition-colors"
                    >
                      ä¿å­˜æƒé™é…ç½®
                    </button>
                  </div>

                  {/* é¢„è§ˆ */}
                  <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md">
                    <p className="text-sm text-blue-800">
                      <span className="font-semibold">ğŸ’¡ æç¤ºï¼š</span>
                      é…ç½®ä¿å­˜åç«‹å³ç”Ÿæ•ˆã€‚å…³é—­æŸä¸ªåŠŸèƒ½åï¼Œé¦–é¡µå°†ä¸æ˜¾ç¤ºå¯¹åº”çš„æŒ‰é’®æˆ–è¾“å…¥æ¡†ã€‚
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* AIæœåŠ¡é…ç½® */}
            {activeTab === 'services' && (
              <div className="space-y-6">
                <div className="bg-white rounded-md border border-slate-200 p-6">
                  <h2 className="text-lg font-semibold mb-6">AIæœåŠ¡æ˜¾ç¤ºé…ç½®</h2>
                  <p className="text-slate-500 text-sm mb-6">é€‰æ‹©åœ¨é¦–é¡µ"å¸¸ç”¨AIæœåŠ¡"åŒºåŸŸæ˜¾ç¤ºå“ªäº›æœåŠ¡ã€‚æœªé€‰æ‹©çš„æœåŠ¡å°†ä¸ä¼šåœ¨é¦–é¡µæ˜¾ç¤ºã€‚</p>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                    {AVAILABLE_SERVICES.map(service => {
                      const isSelected = visibleServices.length === 0 || visibleServices.includes(service.id);
                      return (
                        <label
                          key={service.id}
                          className={`flex items-center gap-4 p-4 rounded-lg border-2 cursor-pointer transition-all ${
                            isSelected ? 'border-blue-500 bg-blue-50' : 'border-slate-200 hover:border-slate-300'
                          }`}
                        >
                          <input
                            type="checkbox"
                            checked={isSelected}
                            onChange={(e) => {
                              if (e.target.checked) {
                                setVisibleServices([...visibleServices, service.id]);
                              } else {
                                setVisibleServices(visibleServices.filter(id => id !== service.id));
                              }
                            }}
                            className="w-5 h-5 rounded text-blue-600"
                          />
                          <div className="w-10 h-10 rounded-lg flex items-center justify-center text-white">
                            <div className={`w-6 h-6 ${service.color} rounded-md`}></div>
                          </div>
                          <span className="font-medium text-slate-800">{service.name}</span>
                        </label>
                      );
                    })}
                  </div>

                  <div className="space-y-4">
                    <div className="flex items-center gap-2 p-4 bg-amber-50 border border-amber-200 rounded-md">
                      <Icon name="database" size={20} className="text-amber-600" />
                      <div>
                        <h3 className="font-semibold text-amber-900">å…¨é€‰çŠ¶æ€</h3>
                        <p className="text-sm text-amber-700">
                          {visibleServices.length === 0 ? 'å½“å‰æ˜¾ç¤ºå…¨éƒ¨4ä¸ªæœåŠ¡ï¼ˆé»˜è®¤çŠ¶æ€ï¼‰' : `å½“å‰å·²é€‰æ‹© ${visibleServices.length} ä¸ªæœåŠ¡`}
                        </p>
                      </div>
                      {visibleServices.length > 0 && (
                        <button
                          onClick={() => setVisibleServices([])}
                          className="ml-auto px-3 py-1 text-sm bg-amber-600 text-white rounded hover:bg-amber-700"
                        >
                          é‡ç½®ä¸ºå…¨é€‰
                        </button>
                      )}
                    </div>
                  </div>

                  <div className="mt-8 pt-6 border-t border-slate-200">
                    <button
                      onClick={handleUpdateServices}
                      className="px-6 py-2 bg-[#1a3a5f] hover:bg-[#254a7a] text-white rounded-md font-medium transition-colors"
                    >
                      ä¿å­˜AIæœåŠ¡é…ç½®
                    </button>
                  </div>

                  {/* é¢„è§ˆ */}
                  <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md">
                    <p className="text-sm text-blue-800">
                      <span className="font-semibold">ğŸ’¡ æç¤ºï¼š</span>
                      é…ç½®ä¿å­˜åç«‹å³ç”Ÿæ•ˆã€‚é¦–é¡µå°†åªæ˜¾ç¤ºé€‰ä¸­çš„AIæœåŠ¡å¿«æ·å…¥å£ã€‚
                    </p>
                  </div>
                </div>
              </div>
            )}

            {/* æ•°æ®åº“æŸ¥çœ‹ */}
            {activeTab === 'database' && (
              <div className="bg-white rounded-md border border-slate-200 p-6">
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-lg font-semibold">æ•°æ®åº“æ•°æ®</h2>
                  <button
                    onClick={loadAllData}
                    className="flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors"
                  >
                    <Icon name="refresh" size={16} />
                    åˆ·æ–°
                  </button>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full text-sm">
                    <thead className="bg-slate-50 border-b border-slate-200">
                      <tr>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">ID</th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">å¤‡æ³¨</th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">è´¦å·</th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">å¯†ç </th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">2FAå¯†é’¥</th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">åˆ›å»ºæ—¶é—´</th>
                        <th className="px-4 py-3 text-left font-semibold text-slate-600">æ›´æ–°æ—¶é—´</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-slate-200">
                      {dbData.map((row, idx) => (
                        <tr key={idx} className="hover:bg-slate-50 font-mono">
                          <td className="px-4 py-3 text-slate-600">{row.id}</td>
                          <td className="px-4 py-3">{row.name || '-'}</td>
                          <td className="px-4 py-3">{row.email}</td>
                          <td className="px-4 py-3 text-slate-500">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</td>
                          <td className="px-4 py-3 text-slate-500">{row.secret ? 'â—â—â—â—â—â—' : '-'}</td>
                          <td className="px-4 py-3 text-slate-500 text-xs">{row.created_at}</td>
                          <td className="px-4 py-3 text-slate-500 text-xs">{row.updated_at}</td>
                        </tr>
                      ))}
                      {dbData.length === 0 && (
                        <tr>
                          <td colSpan="7" className="px-4 py-12 text-center text-slate-400">
                            æ•°æ®åº“ä¸ºç©º
                          </td>
                        </tr>
                      )}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </main>
        </div>
      );
    };

    // æ¸²æŸ“åº”ç”¨
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<AdminPanel />);
  </script>
</body>
</html>
